<!--Configuration settings for log4net-->
<log4net>
  <appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender">
      <layout type="log4net.Layout.PatternLayout, log4net">
      <param name="ConversionPattern" value="%d %p %m%n"/>
    </layout>
  </appender>
  <!--This appender writes NHibernate calls to a file-->
  <appender name="NHibernateRollingFile" type="log4net.Appender.RollingFileAppender,log4net">
    <param name="File" value="LogFiles\NHibernateSQL.log"/>
    <param name="AppendToFile" value="true"/>
    <param name="DatePattern" value="yyyy.MM.dd"/>
    <!--A flexible layout configurable with pattern string.-->
    <layout type="log4net.Layout.PatternLayout,log4net">
      <!--http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html-->
      <conversionPattern value="%d %p %m%n"/>
    </layout>
  </appender>
  <appender name="GeneralFileLog" type="log4net.Appender.RollingFileAppender">
    <file value="LogFiles\MvcWebApplication.log" />      
    <appendToFile value="true" />      
    <maximumFileSize value="10MB" />
    <maxSizeRollBackups value="20" />
    <datePattern value="yyyyMMdd" />
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
    <rollingStyle value="Composite" />         
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%-2thread] {%-5level} %logger - %message%newline"/>
        <!--%date{MM/dd HH:mm:ss}-->
      </layout>
  </appender>
  <appender name="ErrorFileLog" type="log4net.Appender.RollingFileAppender">
    <file value="LogFiles\Error.log" />      
    <appendToFile value="true" />      
    <level value="WARN" />
    <maximumFileSize value="10MB" />
    <maxSizeRollBackups value="20" />
    <filter type="log4net.Filter.LevelRangeFilter">
     <acceptOnMatch value="true" />
     <levelMin value="ERROR" />
     <levelMax value="FATAL" />
    </filter>
    <datePattern value="yyyyMMdd" />
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
    <rollingStyle value="Composite" />         
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%-2thread] {%-5level} %logger - %message%newline"/>
      <!--%date{MM/dd HH:mm:ss}-->
    </layout>
  </appender>
  <appender name="ADONetAppender" type="log4net.Appender.AdoNetAppender">
    <!-- script for creating logging table 
    
    CREATE TABLE [dbo].[Log] ( 
  [ID] [int] IDENTITY (1, 1) NOT NULL , 
  [Date] [datetime] NOT NULL , 
  [Thread] [varchar] (255) NOT NULL , 
  [Level] [varchar] (20) NOT NULL , 
  [Logger] [varchar] (255) NOT NULL , 
  [Message] [varchar] (4000) NOT NULL 
) ON [PRIMARY]
       
    -->
    <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
    <connectionString value="data source=.\SQLEXPRESS;Database=MyFinance;Trusted_Connection=true;" />
    <commandText value="INSERT INTO Log ([Date],[Thread],[Level],[Logger],[Message]) VALUES (@log_date, @thread, @log_level, @logger, @message)" />
    <parameter>
      <parameterName value="@log_date" />
      <dbType value="DateTime" />
      <layout type="log4net.Layout.PatternLayout" value="%date{yyyy'-'MM'-'dd HH':'mm':'ss'.'fff}" />
    </parameter>
    <parameter>
      <parameterName value="@thread" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout" value="%thread" />
    </parameter>
    <parameter>
      <parameterName value="@log_level" />
      <dbType value="String" />
      <size value="50" />
      <layout type="log4net.Layout.PatternLayout" value="%level" />
    </parameter>
    <parameter>
      <parameterName value="@logger" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout" value="%logger" />
    </parameter>
    <parameter>
      <parameterName value="@message" />
      <dbType value="String" />
      <size value="4000" />
      <layout type="log4net.Layout.PatternLayout" value="%message" />
    </parameter>
  </appender>
  <root>
    <!-- Value of priority may be ALL, DEBUG, INFO, WARN, ERROR, FATAL, OFF -->
    <priority value="DEBUG"/>
    <appender-ref ref="ColoredConsoleAppender"/>
    <appender-ref ref="GeneralFileLog" />
    <appender-ref ref="ErrorFileLog" />
  </root>
  <!--Only receives the sql statements generated by NHibernate-->
  <!--http://nhforge.org/wikis/howtonh/configure-log4net-for-use-with-nhibernate.aspx-->
  <logger name="NHibernate.SQL" additivity="false">
    <level value="ALL"/>
    <appender-ref ref="NHibernateRollingFile" />
    <appender-ref ref="ConsoleAppender" />
  </logger>
</log4net>